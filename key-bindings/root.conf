
# vi: filetype=tmux

# ==============================================================================
# PREFIX
# ==============================================================================
set-option -g prefix C-a
bind-key C-a send-prefix
unbind-key C-b


# ==============================================================================
# CLIENT
# ==============================================================================

# Detach Client <Ctrl-n>
bind-key -n C-q detach-client


# ==============================================================================
# SESSION
# ==============================================================================

# Choose Session <M-a>
bind-key -n M-a choose-session

# Switch Sessions <Alt-Shift-Direction>
bind-key -n M-J switch-client -n
bind-key -n M-K switch-client -p

# Switch to Last Session <M-_>
bind-key -n M-_ switch-client -l

# Rename Session <Ctrl-R>
#bind-key -n C-R command-prompt 'rename-session %%'
#bind-key -n C-S-R command-prompt 'rename-session %%'


# ==============================================================================
# WINDOWS
# ==============================================================================

# New Window <Alt-Shift-N>
bind-key -n M-N new-window -c '#{pane_current_path}'

# Switch Windows <Alt-Shift-Direction>
bind-key -n M-H previous-window
bind-key -n M-L     next-window

# Swap Windows <Alt-Shift-Arrow>
bind-key -n S-M-Left  swap-window -t -1
bind-key -n S-M-Right swap-window -t +1

# Close Window <Alt-Shift-W>
#bind-key -n M-W confirm-before -p "kill-window #W? (y/n)" kill-window
#bind-key -n M-W kill-window

# Rename Window <Ctrl-r>
bind-key -n M-r command-prompt 'rename-window %%'

# Select Windows <Alt-#>
bind-key -n M-1 select-window -t 1
bind-key -n M-2 select-window -t 2
bind-key -n M-3 select-window -t 3
bind-key -n M-4 select-window -t 4
bind-key -n M-5 select-window -t 5
bind-key -n M-6 select-window -t 6
bind-key -n M-7 select-window -t 7
bind-key -n M-8 select-window -t 8
bind-key -n M-9 select-window -t 9
bind-key -n M-0 select-window -t 10

# Switch to Last Window <M-->
bind-key -n M-- select-window -l

# Synchronize Panes <M-Z>/<M-z>
bind-key -n M-Z set-window-option synchronize-panes on
bind-key -n M-z set-window-option synchronize-panes off


# ==============================================================================
# PANES
# ==============================================================================

# New Pane <Alt-S/s/V/v>
bind-key -n M-S split-window -vbd -c '#{pane_current_path}'
bind-key -n M-s split-window -v   -c '#{pane_current_path}'
bind-key -n M-V split-window -hbd -c '#{pane_current_path}'
bind-key -n M-v split-window -h   -c '#{pane_current_path}'

# New Pane <Prefix -|>
bind-key | split-window -h
bind-key - split-window -v

# Switch Panes <Alt-Direction>
# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
# Disabled because switching is too laggy
#tmux_select_pane_left=M-h
#tmux_select_pane_right=M-l
#tmux_select_pane_up=M-k
#tmux_select_pane_down=M-j
#tmux_select_pane_last=M--
#is_vim="ps -o state= -o comm= -t '#{pane_tty}' | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
#bind-key -n $tmux_select_pane_left if-shell "$is_vim" "send-keys $tmux_select_pane_left" "select-pane -L"
#bind-key -n $tmux_select_pane_right if-shell "$is_vim" "send-keys $tmux_select_pane_right" "select-pane -R"
#bind-key -n $tmux_select_pane_up if-shell "$is_vim" "send-keys $tmux_select_pane_up" "select-pane -U"
#bind-key -n $tmux_select_pane_down if-shell "$is_vim" "send-keys $tmux_select_pane_down" "select-pane -D"
#bind-key -n $tmux_select_pane_last if-shell "$is_vim" "send-keys $tmux_select_pane_last" "select-pane -l"
bind-key -n M-k select-pane -U
bind-key -n M-j select-pane -D
bind-key -n M-h select-pane -L
bind-key -n M-l select-pane -R

# Resize Pane <Alt-Arrow>
bind-key -n M-Left  resize-pane -L
bind-key -n M-Right resize-pane -R
bind-key -n M-Up    resize-pane -U
bind-key -n M-Down  resize-pane -D

# Zoom Pane <Alt-f>
bind-key -n M-f resize-pane -Z

# Swap Panes <Alt-page up/down>
bind-key -n M-PPage swap-pane -U
bind-key -n M-NPage swap-pane -D

# Close Pane <Alt-w>
#bind-key -n M-w confirm-before -p "kill-pane #P? (y/n)" kill-pane
#bind-key -n M-w kill-pane
bind-key -n M-w run-shell ~/.tmux/bin/kill-pane.bash

# Even Layout <Alt-e>
bind-key -n M-= select-layout -E



# ==============================================================================
# MISC
# ==============================================================================

# Reload .tmux.conf <C-F5>
bind-key -n C-F5 source-file ~/.tmux.conf

# Choose colorscheme <M-S-1/2/3/4/5/6>
bind-key -n 'M-!' run-shell '~/.tmux/bin/colorscheme.zsh red'
bind-key -n 'M-@' run-shell '~/.tmux/bin/colorscheme.zsh yellow'
bind-key -n 'M-#' run-shell '~/.tmux/bin/colorscheme.zsh green'
bind-key -n 'M-$' run-shell '~/.tmux/bin/colorscheme.zsh blue'
bind-key -n 'M-%' run-shell '~/.tmux/bin/colorscheme.zsh purple'
bind-key -n 'M-^' run-shell '~/.tmux/bin/colorscheme.zsh black'

# Command prompt
bind-key Enter command-prompt

